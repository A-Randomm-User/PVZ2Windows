<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>Excel 链接表</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<style>
  body { font-family: Arial; margin: 20px; }
  table { border-collapse: collapse; width: 100%; margin-top: 20px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  th { background-color: #f5f5f5; }
  a { color: #0078d4; text-decoration: none; }
  a:hover { text-decoration: underline; }
</style>
</head>
<body>
<h2>Excel 数据表</h2>
<div id="tableContainer">正在加载 data.xlsx...</div>

<script>
async function loadExcel() {
  try {
    const response = await fetch('data.xlsx');
    const arrayBuffer = await response.arrayBuffer();

    const workbook = XLSX.read(arrayBuffer, { type: 'array' });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

    let html = "<table>";
    rows.forEach((row, i) => {
      html += "<tr>";
      row.forEach(cell => {
        let cellContent = cell ?? "";

        // 如果是网址，就变成可点击链接
        if (typeof cellContent === "string" && cellContent.match(/^https?:\/\//i)) {
          cellContent = `<a href="${cellContent}" target="_blank">链接</a>`;
        }

        html += i === 0
          ? `<th>${cellContent}</th>`
          : `<td>${cellContent}</td>`;
      });
      html += "</tr>";
    });
    html += "</table>";

    document.getElementById('tableContainer').innerHTML = html;
  } catch (err) {
    document.getElementById('tableContainer').innerHTML =
      `<p style="color:red;">❌ 无法加载 data.xlsx：${err.message}</p>`;
  }
}

loadExcel();
</script>
</body>
</html>